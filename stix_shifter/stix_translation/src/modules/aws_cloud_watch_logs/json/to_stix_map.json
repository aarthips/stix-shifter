{
  "vpcflow": {
    "@timestamp": [
      {
        "key": "first_observed",
        "cybox": false,
        "transformer": "AwsToTimestamp"
      },
      {
        "key": "last_observed",
        "cybox": false,
        "transformer": "AwsToTimestamp"
      }
    ],
    "srcAddr": [
      {
        "key": "ipv4-addr.value",
        "object": "src_ip"
      },
      {
        "key": "ipv6-addr.value",
        "object": "src_ip"
      },
      {
        "key": "network-traffic.src_ref",
        "object": "nt",
        "references": "src_ip"
      }
    ],
    "dstAddr": [
      {
        "key": "ipv4-addr.value",
        "object": "dst_ip"
      },
      {
        "key": "ipv6-addr.value",
        "object": "dst_ip"
      },
      {
        "key": "network-traffic.dst_ref",
        "object": "nt",
        "references": "dst_ip"
      }
    ],
    "srcPort": [
      {
        "key": "network-traffic.src_port",
        "object": "nt",
        "transformer": "ToInteger"
      }
    ],
    "dstPort": [
      {
        "key": "network-traffic.dst_port",
        "object": "nt",
        "transformer": "ToInteger"
      }
    ],
    "protocol": [
      {
        "key": "network-traffic.protocols",
        "object": "nt",
        "transformer": "ToLowercaseArray"
      }
    ],
    "start": [
      {
        "key": "network-traffic.start",
        "object": "nt",
        "transformer": "EpochSecondsToTimestamp"
      }
    ],
    "end": [
      {
        "key": "network-traffic.end",
        "object": "nt",
        "transformer": "EpochSecondsToTimestamp"
      }
    ],
    "accountId": [
      {
        "key": "x_com_vpc_flow.account_id",
        "cybox": false
      }
    ],
    "interfaceId": [
      {
        "key": "x_com_vpc_flow.interface_id",
        "cybox": false
      }
    ],
    "@logStream": [
      {
        "key": "x_com_vpc_flow.log_stream",
        "cybox": false
      }
    ],
    "event_count": [
      {
        "key": "number_observed",
        "cybox": false,
        "transformer": "ToInteger"
      }
    ]
  },
  "guardduty": {
    "NETWORK_CONNECTION": {
      "detail_resource_instanceDetails_networkInterfaces_0_privateIpAddress": [
        {
          "key": "ipv4-addr.value",
          "object": "nc_private_ip"
        },
        {
          "key": "network-traffic.src_ref",
          "object": "nc_nt",
          "references": "nc_private_ip"
        },
        {
          "key": "domain-name.resolves_to_refs",
          "object": "nc_private_name",
          "references": ["nc_private_ip"]
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.private_ip_address_ref",
          "references": "nc_private_ip",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_ipv6Addresses_0": [
        {
          "key": "ipv6-addr.value",
          "object": "nc_ipv6_ip"
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.ipv6_addresses_0_ref",
          "references": "nc_ipv6_ip",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_publicIp": [
        {
          "key": "ipv4-addr.value",
          "object": "nc_public_ip"
        },
        {
          "key": "domain-name.resolves_to_refs",
          "object": "nc_public_name",
          "references": ["nc_public_ip"]
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.public_ip_ref",
          "references": "nc_public_ip",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_privateDnsName": [
        {
          "key": "domain-name.value",
          "object": "nc_private_name"
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.private_dns_name_ref",
          "references": "nc_private_name",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_publicDnsName": [
        {
          "key": "domain-name.value",
          "object": "nc_public_name"
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.public_dns_name_ref",
          "references": "nc_public_name",
          "cybox": false
        }
      ],
      "detail_service_action_networkConnectionAction_remoteIpDetails_ipAddressV4": [
        {
          "key": "ipv4-addr.value",
          "object": "nc_remote_ip"
        },
        {
          "key": "network-traffic.dst_ref",
          "object": "nc_nt",
          "references": "nc_remote_ip"
        },
        {
          "key": "x_com_guardduty_findings.service.action.network_connection_action.remote_ip_details.ip_addressv4.remote_ip_ref",
          "references": "nc_remote_ip",
          "cybox": false
        }
      ],
      "detail_service_action_networkConnectionAction_localPortDetails_port": [
        {
          "key": "network-traffic.src_port",
          "object": "nc_nt",
          "transformer": "ToInteger"
        },
        {
          "key": "x_com_guardduty_findings.service.action.network_connection_action.local_port_details.port_ref",
          "references": "nc_nt",
          "cybox": false
        }
      ],
      "detail_service_action_networkConnectionAction_remotePortDetails_port": [
        {
          "key": "network-traffic.dst_port",
          "object": "nc_nt",
          "transformer": "ToInteger"
        },
        {
          "key": "x_com_guardduty_findings.service.action.network_connection_action.remote_port_details.port_ref",
          "references": "nc_nt",
          "cybox": false
        }
      ],
      "detail_service_action_networkConnectionAction_protocol": [
        {
          "key": "network-traffic.protocols",
          "object": "nc_nt",
          "transformer": "ToLowercaseArray"
        },
        {
          "key": "x_com_guardduty_findings.service.action.network_connection_action.protocol_ref",
          "references": "nc_nt",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_tags_0_key": {
        "key": "x_com_guardduty_findings.resource.instance_details.tags_0.key",
        "cybox": false
      },
      "detail_resource_instanceDetails_tags_0_value": {
        "key": "x_com_guardduty_findings.resource.instance_details.tags_0.value",
        "cybox": false
      },
      "detail_service_action_networkConnectionAction_localPortDetails_portName": [
        {
          "key": "x_com_guardduty_findings.service.action.network_connection_action.local_port_details.port_name",
          "cybox": false
        }
      ],
      "detail_service_action_networkConnectionAction_remotePortDetails_portName": [
        {
          "key": "x_com_guardduty_findings.service.action.network_connection_action.remote_port_details.port_name",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_networkInterfaceId": {
        "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.network_interface_id",
        "cybox": false
      },
      "detail_resource_instanceDetails_networkInterfaces_0_subnetId": {
        "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.subnet_id",
        "cybox": false
      },
      "detail_resource_instanceDetails_networkInterfaces_0_vpcId": {
        "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.vpc_id",
        "cybox": false
      },
      "detail_resource_instanceDetails_networkInterfaces_0_securityGroups_0_groupId": {
        "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.security_groups.group_id",
        "cybox": false
      },
      "detail_resource_instanceDetails_networkInterfaces_0_securityGroups_0_groupName":{
        "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.security_groups.group_name",
        "cybox": false
      },
      "detail_resource_instanceDetails_imageId":{
        "key": "x_com_guardduty_findings.resource.instance_details.image_id",
        "cybox": false
      },
      "detail_resource_instanceDetails_iamInstanceProfile_id": {
        "key": "x_com_guardduty_findings.resource.instance_details.iam_instance_profile.id",
        "cybox": false
      },
      "detail_resource_instanceDetails_instanceId": {
        "key": "x_com_guardduty_findings.resource.instance_details.instance_id",
        "cybox": false
      },
      "detail_region": {
        "key": "x_com_guardduty_findings.region",
        "cybox": false
      },
      "detail_service_action_networkConnectionAction_blocked": {
        "key": "x_com_guardduty_findings.service.action.network_connection_action.blocked",
        "cybox": false
      },
      "detail_service_action_networkConnectionAction_connectionDirection": {
        "key": "x_com_guardduty_findings.service.action.network_connection_action.connection_direction",
        "cybox": false
      },
      "detail_service_action_networkConnectionAction_remoteIpDetails_country_countryName": {
        "key": "x_com_guardduty_findings.service.action.network_connection_action.remote_ip_details.country.country_name",
        "cybox": false
      },
      "detail_service_action_networkConnectionAction_remoteIpDetails_organization_asn": {
        "key": "x_com_guardduty_findings.service.action.network_connection_action.remote_ip_details.organization.asn",
        "cybox": false
      },
      "detail_service_action_networkConnectionAction_remoteIpDetails_organization_asnOrg": {
        "key": "x_com_guardduty_findings.service.action.network_connection_action.remote_ip_details.organization.asn_org",
        "cybox": false
      }
    },
    "PORT_PROBE": {
      "detail_resource_instanceDetails_networkInterfaces_0_privateIpAddress": [
        {
          "key": "ipv4-addr.value",
          "object": "pp_private_ip"
        },
        {
          "key": "domain-name.resolves_to_refs",
          "object": "pp_private_name",
          "references": ["pp_private_ip"]
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.private_ip_address_ref",
          "references": "pp_private_ip",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_ipv6Addresses_0": [
        {
          "key": "ipv6-addr.value",
          "object": "pp_ipv6_ip"
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.ipv6_addresses_0_ref",
          "references": "pp_ipv6_ip",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_privateDnsName": [
        {
          "key": "domain-name.value",
          "object": "pp_private_name"
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.private_dns_name_ref",
          "references": "pp_private_name",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_publicDnsName": [
        {
          "key": "domain-name.value",
          "object": "pp_public_name"
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.public_dns_name_ref",
          "references": "pp_public_name",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_publicIp": [
        {
          "key": "ipv4-addr.value",
          "object": "pp_public_ip"
        },
        {
          "key": "domain-name.resolves_to_refs",
          "object": "pp_public_name",
          "references": ["pp_public_ip"]
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.public_ip_ref",
          "references": "pp_public_ip",
          "cybox": false
        }
      ],
      "detail_service_action_portProbeAction_portProbeDetails_0_remoteIpDetails_ipAddressV4": [
        {
          "key": "ipv4-addr.value",
          "object": "pp_remote_ip"
        },
        {
          "key": "x_com_guardduty_findings.service.action.port_probe_action.port_probe_details_0.remote_ip_ref",
          "references": "pp_remote_ip",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_networkInterfaceId": [
        {
        "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.network_interface_id",
        "cybox": false
        }
      ],
      "detail_service_action_portProbeAction_portProbeDetails_0_localPortDetails_port": [
        {
          "key": "x_com_guardduty_findings.service.action.port_probe_action.port_probe_details_0.port",
          "cybox": false
        }
      ],
      "detail_service_action_portProbeAction_portProbeDetails_0_localPortDetails_portName": [
        {
          "key": "x_com_guardduty_findings.service.action.port_probe_action.port_probe_details_0.port_name",
          "cybox": false
        }
      ],
      "detail_service_action_portProbeAction_portProbeDetails_0_remoteIpDetails_organization_asn": [
        {
          "key": "x_com_guardduty_findings.service.action.port_probe_action.port_probe_details_0.remote_ip_details.organization.asn",
          "cybox": false
        }
      ],
      "detail_service_action_portProbeAction_portProbeDetails_0_remoteIpDetails_organization_asnOrg": [
        {
          "key": "x_com_guardduty_findings.service.action.port_probe_action.port_probe_details_0.remote_ip_details.organization.asn_org",
          "cybox": false
        }
      ],
      "detail_service_action_portProbeAction_portProbeDetails_0_remoteIpDetails_organization_isp": [
        {
          "key": "x_com_guardduty_findings.service.action.port_probe_action.port_probe_details_0.remote_ip_details.organization.isp",
          "cybox": false
        }
      ],
      "detail_service_action_portProbeAction_portProbeDetails_0_remoteIpDetails_country_countryName": [
        {
          "key": "x_com_guardduty_findings.service.action.port_probe_action.port_probe_details_0.remote_ip_details.country.country_name",
          "cybox": false
        }
      ],
      "detail_service_action_portProbeAction_portProbeDetails_0_remoteIpDetails_city_cityName": [
        {
          "key": "x_com_guardduty_findings.service.action.port_probe_action.port_probe_details_0.remote_ip_details.city.city_name",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_imageId":{
        "key": "x_com_guardduty_findings.resource.instance_details.image_id",
        "cybox": false
      },
      "detail_resource_instanceDetails_iamInstanceProfile_id": {
        "key": "x_com_guardduty_findings.resource.instance_details.iam_instance_profile.id",
        "cybox": false
      },
       "detail_resource_instanceDetails_instanceId": {
        "key": "x_com_guardduty_findings.resource.instance_details.instance_id",
        "cybox": false
      },
      "detail_service_additionalInfo_threatListName": {
        "key": "x_com_guardduty_findings.service.additional_info.threat_list_name",
        "cybox": false
      }
    },
    "AWS_API_CALL": {
      "detail_service_action_awsApiCallAction_remoteIpDetails_ipAddressV4": [
        {
          "key": "ipv4-addr.value",
          "object": "api_remote_ip"
        },
        {
          "key": "x_com_guardduty_findings.service.action.aws_api_call_action.remote_ip_details.ip_addressv4_ref",
          "references": "api_remote_ip",
          "cybox": false
        }
      ],
      "detail_resource_accessKeyDetails_principalId": [
        {
          "key": "user-account.user_id",
          "object": "api_user"
        },
        {
            "key": "x_com_guardduty_findings.resource.access_key_details.principal_id_ref",
            "references": "api_user",
            "cybox": false
        }
      ],
      "detail_resource_accessKeyDetails_userName": [
        {
        "key": "user-account.account_login",
        "object": "api_user"
        },
        {
            "key": "x_com_guardduty_findings.resource.access_key_details.user_name_ref",
            "references": "api_user",
            "cybox": false
        }
      ],
      "detail_resource_accessKeyDetails_accessKeyId": {
        "key": "x_com_guardduty_findings.resource.access_key_details.access_key_id",
        "cybox": false
      },
      "detail_resource_accessKeyDetails_userType": {
        "key": "x_com_guardduty_findings.resource.access_key_details.user_type",
        "cybox": false
      },
      "detail_service_action_awsApiCallAction_api": {
        "key": "x_com_guardduty_findings.service.action.aws_api_call_action.api",
        "cybox": false
      },
      "detail_service_action_awsApiCallAction_callerType": {
        "key": "x_com_guardduty_findings.service.action.aws_api_call_action.caller_type",
        "cybox": false
      },
      "detail_service_action_awsApiCallAction_remoteIpDetails_city_cityName": {
        "key": "x_com_guardduty_findings.service.action.aws_api_call_action.remote_ip_details.city.city_name",
        "cybox": false
      },
      "detail_service_action_awsApiCallAction_remoteIpDetails_country_countryName": {
        "key": "x_com_guardduty_findings.service.action.aws_api_call_action.remote_ip_details.country.country_name",
        "cybox": false
      },
      "detail_service_action_awsApiCallAction_remoteIpDetails_organization_asn": {
        "key": "x_com_guardduty_findings.service.action.aws_api_call_action.remote_ip_details.organization.asn",
        "cybox": false
      },
      "detail_service_action_awsApiCallAction_remoteIpDetails_organization_asnOrg": {
        "key": "x_com_guardduty_findings.service.action.aws_api_call_action.remote_ip_details.organization.asn_org",
        "cybox": false
      },
      "detail_service_action_awsApiCallAction_serviceName": {
        "key": "x_com_guardduty_findings.service.action.aws_api_call_action.service_name",
        "cybox": false
      },
      "detail_service_action_awsApiCallAction_remoteIpDetails_organization_isp": {
          "key": "x_com_guardduty_findings.service.action.aws_api_call_action.remote_ip_details.organization.isp",
          "cybox": false
      }
    },
    "DNS_REQUEST": {
      "detail_resource_instanceDetails_networkInterfaces_0_privateIpAddress": [
        {
          "key": "ipv4-addr.value",
          "object": "dns_private_ip"
        },
        {
          "key": "domain-name.resolves_to_refs",
          "object": "dns_private_name",
          "references": ["dns_private_ip"]
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.private_ip_address_ref",
          "references": "dns_private_ip",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_ipv6Addresses_0": [
        {
          "key": "ipv6-addr.value",
          "object": "dns_ipv6_ip"
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.ipv6_addresses_0_ref",
          "references": "dns_ipv6_ip",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_publicIp": [
        {
          "key": "ipv4-addr.value",
          "object": "dns_public_ip"
        },
        {
          "key": "domain-name.resolves_to_refs",
          "object": "dns_public_name",
          "references": ["dns_public_ip"]
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.public_ip_ref",
          "references": "dns_public_ip",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_privateDnsName": [
        {
          "key": "domain-name.value",
          "object": "dns_private_name"
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.private_dns_name_ref",
          "references": "dns_private_name",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_publicDnsName": [
        {
          "key": "domain-name.value",
          "object": "dns_public_name"
        },
        {
          "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.public_dns_name_ref",
          "references": "dns_public_name",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_networkInterfaces_0_networkInterfaceId": {
        "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.network_interface_id",
        "cybox": false
      },
      "detail_resource_instanceDetails_networkInterfaces_0_subnetId": {
        "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.subnet_id",
        "cybox": false
      },
      "detail_resource_instanceDetails_networkInterfaces_0_vpcId": {
        "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.vpc_id",
        "cybox": false
      },
      "detail_resource_instanceDetails_networkInterfaces_0_securityGroups_0_groupId": {
        "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.security_groups.group_id",
        "cybox": false
      },
      "detail_resource_instanceDetails_networkInterfaces_0_securityGroups_0_groupName":{
        "key": "x_com_guardduty_findings.resource.instance_details.network_interfaces_0.security_groups.group_name",
        "cybox": false
      },
      "detail_service_action_dnsRequestAction_domain":[
        {
          "key": "domain-name.value",
          "object": "dns_domain_name"
        },
        {
          "key": "x_com_guardduty_findings.service.action.dns_request_action.domain_ref",
          "references": "dns_domain_name",
          "cybox": false
        }
      ],
      "detail_resource_instanceDetails_imageId":{
        "key": "x_com_guardduty_findings.resource.instance_details.image_id",
        "cybox": false
      },
      "detail_resource_instanceDetails_iamInstanceProfile_id": {
        "key": "x_com_guardduty_findings.resource.instance_details.iam_instance_profile.id",
        "cybox": false
      },
      "detail_resource_instanceDetails_instanceId": {
        "key": "x_com_guardduty_findings.resource.instance_details.instance_id",
        "cybox": false
      },
      "detail_resource_instanceDetails_tags_0_key": {
        "key": "x_com_guardduty_findings.resource.instance_details.tags_0.key",
        "cybox": false
      },
      "detail_resource_instanceDetails_tags_0_value": {
        "key": "x_com_guardduty_findings.resource.instance_details.tags_0.value",
        "cybox": false
      }
    },
    "@timestamp": {
        "key": "x_com_cwl_timestamp",
        "cybox": false,
        "transformer": "AwsToTimestamp"
    },
    "detail_service_eventFirstSeen": {
        "key": "first_observed",
        "cybox": false
    },
    "detail_service_eventLastSeen": {
        "key": "last_observed",
        "cybox": false
    },
    "source": {
      "key": "x_com_guardduty_findings.source",
      "cybox": false
    },
    "account": {
      "key": "x_com_guardduty_findings.account_id",
      "cybox": false
    },
    "detail_region": {
      "key": "x_com_guardduty_findings.region",
      "cybox": false
    },
    "detail_id": {
      "key": "x_com_guardduty_findings.id",
      "cybox": false
    },
    "detail_service_resourceRole": {
      "key": "x_com_guardduty_findings.service.resource_role",
      "cybox": false
    },
    "detail_severity": {
      "key": "x_com_guardduty_findings.severity",
      "cybox": false
    },
    "detail_type": {
      "key": "x_com_guardduty_findings.type",
      "cybox": false
    },
    "detail_updatedAt": {
      "key": "x_com_guardduty_findings.updated_at",
      "cybox": false
    },
    "detail_resource_resourceType": {
      "key": "x_com_guardduty_findings.resource.resource_type",
      "cybox": false
    },
    "detail_service_action_actionType": {
      "key": "x_com_guardduty_findings.service.action.action_type",
      "cybox": false
    },
    "detail_title": {
      "key": "x_com_guardduty_findings.title",
      "cybox": false
    },
    "event_count": [
      {
        "key": "number_observed",
        "cybox": false,
        "transformer": "ToInteger"
      }
    ]
  }
}